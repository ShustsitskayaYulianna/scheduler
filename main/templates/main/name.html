<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Расписание</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous"></head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

</head>
<body>
<div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
      <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="32" fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16">
          <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
        </svg>
        <span class="fs-4">ChurchMonthScheduler</span>
      </a>

      <ul class="nav nav-pills">
        <li class="nav-item"><a href="#" class="nav-link active" aria-current="page">Home</a></li>
      </ul>
    </header>
  </div>

    {% block content %}

  <div class="container">
    <main>
    <form class="needs-validation" novalidate="" action="{% url 'createDoc' %}" method="get">
      {% csrf_token %}
      <div class="row g-5">
        <div class="col-md-5 col-lg-4 order-md-last">
        </div>
        <div class="col-md-30 col-lg-30">
          <h4 class="mb-3">РАСПИСАНИЕ БОГОСЛУЖЕНИЙ В ПРИХОДЕ ХРАМА ПРЕОБРАЖЕНИЯ ГОСПОДНЯ г. МИНСКА на <input name="month" type="text" value="{{ month }}"></input> <input name="year" type="text" value="{{ year }}"></input></h4>
            {% for holid, day, data, len, links in all_data %}
            <div class="row g-1">
                <div class="col-sm-2">
                  <input name="days" type="text" class="form-control" id="dayAndDate-{{len}}" placeholder="" value="{{day}} , {{data}}" required="" >
                  <div class="invalid-feedback">
                    Valid first name is required.
                  </div>
                </div>

                <div class="col-sm-7">
                  <i><textarea class="form-control" name="holidays" id="holidays-{{len}}">{{holid}}</textarea></i>
                  <!--style="color: black"-->
                  <div class="invalid-feedback">
                    Valid last name is required.
                  </div>

                  <div class="row g-2">
                    <div class="form-floating col-sm-2">
                      <select class="form-select" id="timeSelect-{{len}}">
                        {% for t in time %}
                        <option selected value="{{t}}">{{t}}</option>
                        {% endfor %}
                      </select>
                      <label for="timeSelect-{{len}}">Время</label>
                    </div>
                    <div class="form-floating col-sm-8">
                      <select class="form-select" id="worshipSelect-{{len}}">
                        {% for w in worship %}
                        <option selected value="{{w}}">{{w}}</option>
                        {% endfor %}
                      </select>
                      <label for="worshipSelect-{{len}}">Службы</label>
                    </div>
                    <div class="form-floating col-sm-1 g-3">
                       <button type="button" id="add-{{len}}" name="{{day}}" value="{{day}}" class="btn btn-outline-success" onclick="getWorchipAndTimeValuesAndShowIt(this.id)">+</button>
                    </div>
                  </div>
                  <div class="row g-2" id="output-{{len}}">
                    <div class="form-floating col-sm-1 g-3" id="outputButton-{{len}}">
                    </div>
                    <textarea class="form-control col-sm-11" name="outputWorship" id="worshipsDiv-{{len}}"></textarea>
                    <!--<div class="form-floating col-sm-1" id="del-{{len}}>
                      <button hidden id="del-{{len}}" class="btn btn-outline-danger" type="button" name="createButton" value="1" onclick="deleteWorshipWithTimeByClickingDeleteButton(this.id)">-</button>
                    </div>
                    <div class="form-floating col-sm-11" name="worship">
                      <p hidden id="worship" type="text" value="Воскресение" name="worship" placeholder="Enter value"></p>
                    </div> -->
                  </div>
                  <hr class="my-4">
                </div>
              <div class="form-floating col-sm-3 g-3">
                      <button type="button" id="color-{{len}}" name="colorButton" class="btn btn-outline-danger" value="black" style="color: white" onclick="getIdByClickAndChangeColor(this.id)">R</button>
                      <button type="button" id="bold-{{len}}" name="boldButton" class="btn btn-outline-dark" value="normal" onclick="getIdByClickAndChangeFontWeightToBold(this.id)">B</button>
                      <a class="btn btn-danger" href="{{links}}" role="button" target="_blank">i</a>

              </div>
            </div>
            {% endfor %}
            </div>
            <!--<button class="w-100 btn btn-primary btn-lg g-5" type="download">download</button>-->
            <button class="w-30 btn btn-primary btn-lg g-5" type="download">Download Doc</button>
        </div>
      </form>
    </main>
  </div>

  <footer class="my-5 pt-5 text-body-secondary text-center text-small">
    <p class="mb-1">© 2017–2024 Company Name</p>
    <ul class="list-inline">
      <li class="list-inline-item"><a href="#">Privacy</a></li>
      <li class="list-inline-item"><a href="#">Terms</a></li>
      <li class="list-inline-item"><a href="#">Support</a></li>
    </ul>
  </footer>
</div>

    {% endblock %}

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
<script type="text/javascript">
    var colorButtonId
    var counter = 0

    function getOnlyId(element) {
      //return element.match(/\d+/g);
      return element.split("-")[1]
    }

    function getIdByClickAndChangeColor(clicked_id)
    {
      colorButtonId = clicked_id;
      var colorButtonById = document.getElementById("color-" + getOnlyId(colorButtonId));
      var holidayById = document.getElementById("holidays-" + getOnlyId(colorButtonId));
      if (colorButtonById.getAttribute("value") == "black") {
        holidayById.style.color = 'red';
        holidayById.setAttribute('value', "red")
        colorButtonById.style.backgroundColor = 'red';
        colorButtonById.style.color = 'red';
        colorButtonById.setAttribute("value", "red");
      }
      else {
        holidayById.style.color = 'black';
        colorButtonById.style.backgroundColor = 'white';
        colorButtonById.setAttribute("value", "black");
        holidayById.setAttribute('value', "")
        }
   }

   function getIdByClickAndChangeFontWeightToBold(clicked_id) {
     boldButtonId = clicked_id;
     var boldButtonById = document.getElementById("bold-" + getOnlyId(boldButtonId));
     var holidayById = document.getElementById("holidays-" + getOnlyId(boldButtonId));

     if (boldButtonById.getAttribute("value") == "normal") {
       holidayById.style.fontWeight = "bold";
       boldButtonById.style.backgroundColor = 'black';
       boldButtonById.style.color = 'white';
       boldButtonById.setAttribute("value", "bold");
       holidayById.setAttribute('value', "bold")
     } else {
       holidayById.style.fontWeight = "normal";
       boldButtonById.style.backgroundColor = 'white';
       boldButtonById.style.color = 'black';
       boldButtonById.setAttribute("value", "normal");
     }
   }


    function getWorchipAndTimeValuesAndShowIt(clicked_id) {
      buttonId = clicked_id;

      var addButton = document.getElementById("add-" +getOnlyId(buttonId));
      var selectWorshipElement = document.getElementById("worshipSelect-" + getOnlyId(buttonId));
      var outputHolidaySelect = selectWorshipElement.options[selectWorshipElement.selectedIndex].value + '\n';

      var selectTimeElement = document.getElementById("timeSelect-" + getOnlyId(buttonId))
      var outputTimeSelect = selectTimeElement.options[selectTimeElement.selectedIndex].value;

      var outputButton = document.getElementById("outputButton-" + getOnlyId(buttonId));
      var createdTextField = document.getElementById("worshipsDiv-" + getOnlyId(buttonId))

      var commonOutput = outputTimeSelect + " - " + outputHolidaySelect;

      var outputElement = document.getElementById("output-" + getOnlyId(buttonId));
      const divForTextField = document.createElement("div");
      const divForButtonField = document.createElement("div");

      divForButtonField.setAttribute("class", "form-floating col-sm-1 g-3");
      divForTextField.setAttribute("class", "form-floating col-sm-11");
      divForTextField.setAttribute("name", "worshipDiv-"+ getOnlyId(buttonId));

      createdTextField.textContent += commonOutput;
    }

    function deleteWorshipWithTimeByClickingDeleteButton(clicked_id) {
      buttonId = clicked_id;
      divForButtonField = document.getElementById("del" + "-" + getOnlyId(buttonId));

      divForButtonField.parentElement.nextElementSibling.remove();
      divForButtonField.parentElement.remove();
    }
</script>
</body>
</html>
